/*************************************************/
/* This file was auto-generated by xlgen.        */
/* Don't edit it directly, it'll be overwritten! */
/* Modify the matching .xl file and rebuild.     */
/*************************************************/
/*
 * Copyright (c) 2019 askmeaboutloom
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
#include <rouse.h>
#include "lua_inc.h"
#include "intern.h"
#include "util.h"



static int r_ease_linear_xl(lua_State *L)
{
    float k = XL_checkfloat(L, 1);
    float RETVAL;
    RETVAL = R_ease_linear(k, R_user_null());
    XL_pushfloat(L, RETVAL);
    return 1;
}

static int r_ease_bounce_in_xl(lua_State *L)
{
    float k = XL_checkfloat(L, 1);
    float RETVAL;
    RETVAL = R_ease_bounce_in(k, R_user_null());
    XL_pushfloat(L, RETVAL);
    return 1;
}

static int r_ease_bounce_out_xl(lua_State *L)
{
    float k = XL_checkfloat(L, 1);
    float RETVAL;
    RETVAL = R_ease_bounce_out(k, R_user_null());
    XL_pushfloat(L, RETVAL);
    return 1;
}

static int r_ease_bounce_in_out_xl(lua_State *L)
{
    float k = XL_checkfloat(L, 1);
    float RETVAL;
    RETVAL = R_ease_bounce_in_out(k, R_user_null());
    XL_pushfloat(L, RETVAL);
    return 1;
}

static int r_ease_cubic_in_xl(lua_State *L)
{
    float k = XL_checkfloat(L, 1);
    float RETVAL;
    RETVAL = R_ease_cubic_in(k, R_user_null());
    XL_pushfloat(L, RETVAL);
    return 1;
}

static int r_ease_cubic_out_xl(lua_State *L)
{
    float k = XL_checkfloat(L, 1);
    float RETVAL;
    RETVAL = R_ease_cubic_out(k, R_user_null());
    XL_pushfloat(L, RETVAL);
    return 1;
}

static int r_ease_cubic_in_out_xl(lua_State *L)
{
    float k = XL_checkfloat(L, 1);
    float RETVAL;
    RETVAL = R_ease_cubic_in_out(k, R_user_null());
    XL_pushfloat(L, RETVAL);
    return 1;
}

static int r_ease_elastic_in_xl(lua_State *L)
{
    float k = XL_checkfloat(L, 1);
    float RETVAL;
    RETVAL = R_ease_elastic_in(k, R_user_null());
    XL_pushfloat(L, RETVAL);
    return 1;
}

static int r_ease_elastic_out_xl(lua_State *L)
{
    float k = XL_checkfloat(L, 1);
    float RETVAL;
    RETVAL = R_ease_elastic_out(k, R_user_null());
    XL_pushfloat(L, RETVAL);
    return 1;
}

static int r_ease_elastic_in_out_xl(lua_State *L)
{
    float k = XL_checkfloat(L, 1);
    float RETVAL;
    RETVAL = R_ease_elastic_in_out(k, R_user_null());
    XL_pushfloat(L, RETVAL);
    return 1;
}

static int r_ease_back_in_xl(lua_State *L)
{
    float k = XL_checkfloat(L, 1);
    float RETVAL;
    RETVAL = R_ease_back_in(k, R_user_null());
    XL_pushfloat(L, RETVAL);
    return 1;
}

static int r_ease_back_out_xl(lua_State *L)
{
    float k = XL_checkfloat(L, 1);
    float RETVAL;
    RETVAL = R_ease_back_out(k, R_user_null());
    XL_pushfloat(L, RETVAL);
    return 1;
}

static int r_ease_back_in_out_xl(lua_State *L)
{
    float k = XL_checkfloat(L, 1);
    float RETVAL;
    RETVAL = R_ease_back_in_out(k, R_user_null());
    XL_pushfloat(L, RETVAL);
    return 1;
}

static int r_ease_quint_in_xl(lua_State *L)
{
    float k = XL_checkfloat(L, 1);
    float RETVAL;
    RETVAL = R_ease_quint_in(k, R_user_null());
    XL_pushfloat(L, RETVAL);
    return 1;
}

static int r_ease_quint_out_xl(lua_State *L)
{
    float k = XL_checkfloat(L, 1);
    float RETVAL;
    RETVAL = R_ease_quint_out(k, R_user_null());
    XL_pushfloat(L, RETVAL);
    return 1;
}

static int r_ease_quint_in_out_xl(lua_State *L)
{
    float k = XL_checkfloat(L, 1);
    float RETVAL;
    RETVAL = R_ease_quint_in_out(k, R_user_null());
    XL_pushfloat(L, RETVAL);
    return 1;
}

static int r_ease_quad_in_xl(lua_State *L)
{
    float k = XL_checkfloat(L, 1);
    float RETVAL;
    RETVAL = R_ease_quad_in(k, R_user_null());
    XL_pushfloat(L, RETVAL);
    return 1;
}

static int r_ease_quad_out_xl(lua_State *L)
{
    float k = XL_checkfloat(L, 1);
    float RETVAL;
    RETVAL = R_ease_quad_out(k, R_user_null());
    XL_pushfloat(L, RETVAL);
    return 1;
}

static int r_ease_quad_in_out_xl(lua_State *L)
{
    float k = XL_checkfloat(L, 1);
    float RETVAL;
    RETVAL = R_ease_quad_in_out(k, R_user_null());
    XL_pushfloat(L, RETVAL);
    return 1;
}

static int r_ease_quart_in_xl(lua_State *L)
{
    float k = XL_checkfloat(L, 1);
    float RETVAL;
    RETVAL = R_ease_quart_in(k, R_user_null());
    XL_pushfloat(L, RETVAL);
    return 1;
}

static int r_ease_quart_out_xl(lua_State *L)
{
    float k = XL_checkfloat(L, 1);
    float RETVAL;
    RETVAL = R_ease_quart_out(k, R_user_null());
    XL_pushfloat(L, RETVAL);
    return 1;
}

static int r_ease_quart_in_out_xl(lua_State *L)
{
    float k = XL_checkfloat(L, 1);
    float RETVAL;
    RETVAL = R_ease_quart_in_out(k, R_user_null());
    XL_pushfloat(L, RETVAL);
    return 1;
}

static int r_ease_sine_in_xl(lua_State *L)
{
    float k = XL_checkfloat(L, 1);
    float RETVAL;
    RETVAL = R_ease_sine_in(k, R_user_null());
    XL_pushfloat(L, RETVAL);
    return 1;
}

static int r_ease_sine_out_xl(lua_State *L)
{
    float k = XL_checkfloat(L, 1);
    float RETVAL;
    RETVAL = R_ease_sine_out(k, R_user_null());
    XL_pushfloat(L, RETVAL);
    return 1;
}

static int r_ease_sine_in_out_xl(lua_State *L)
{
    float k = XL_checkfloat(L, 1);
    float RETVAL;
    RETVAL = R_ease_sine_in_out(k, R_user_null());
    XL_pushfloat(L, RETVAL);
    return 1;
}

static int r_ease_expo_in_xl(lua_State *L)
{
    float k = XL_checkfloat(L, 1);
    float RETVAL;
    RETVAL = R_ease_expo_in(k, R_user_null());
    XL_pushfloat(L, RETVAL);
    return 1;
}

static int r_ease_expo_out_xl(lua_State *L)
{
    float k = XL_checkfloat(L, 1);
    float RETVAL;
    RETVAL = R_ease_expo_out(k, R_user_null());
    XL_pushfloat(L, RETVAL);
    return 1;
}

static int r_ease_expo_in_out_xl(lua_State *L)
{
    float k = XL_checkfloat(L, 1);
    float RETVAL;
    RETVAL = R_ease_expo_in_out(k, R_user_null());
    XL_pushfloat(L, RETVAL);
    return 1;
}


typedef struct R_LuaEaseFn {
    R_MAGIC_FIELD
    R_EaseFn ease;
} R_LuaEaseFn;

static int easings_dummy;

static void set_named_easing(lua_State *L, const char *name, R_EaseFn ease)
{
    R_LuaEaseFn le = {R_MAGIC_INIT(R_LuaEaseFn) ease};
    R_MAGIC_CHECK(R_LuaEaseFn, &le);
    XL_pushnewutypeuv(L, &le, sizeof(le), "R_LuaEaseFn", 0);
    lua_setfield(L, -2, name);
}

static void init_named_easings(lua_State *L)
{
    lua_createtable(L, 0, 28);
    set_named_easing(L, "linear", R_ease_linear);
    set_named_easing(L, "bounce_in", R_ease_bounce_in);
    set_named_easing(L, "bounce_out", R_ease_bounce_out);
    set_named_easing(L, "bounce_in_out", R_ease_bounce_in_out);
    set_named_easing(L, "cubic_in", R_ease_cubic_in);
    set_named_easing(L, "cubic_out", R_ease_cubic_out);
    set_named_easing(L, "cubic_in_out", R_ease_cubic_in_out);
    set_named_easing(L, "elastic_in", R_ease_elastic_in);
    set_named_easing(L, "elastic_out", R_ease_elastic_out);
    set_named_easing(L, "elastic_in_out", R_ease_elastic_in_out);
    set_named_easing(L, "back_in", R_ease_back_in);
    set_named_easing(L, "back_out", R_ease_back_out);
    set_named_easing(L, "back_in_out", R_ease_back_in_out);
    set_named_easing(L, "quint_in", R_ease_quint_in);
    set_named_easing(L, "quint_out", R_ease_quint_out);
    set_named_easing(L, "quint_in_out", R_ease_quint_in_out);
    set_named_easing(L, "quad_in", R_ease_quad_in);
    set_named_easing(L, "quad_out", R_ease_quad_out);
    set_named_easing(L, "quad_in_out", R_ease_quad_in_out);
    set_named_easing(L, "quart_in", R_ease_quart_in);
    set_named_easing(L, "quart_out", R_ease_quart_out);
    set_named_easing(L, "quart_in_out", R_ease_quart_in_out);
    set_named_easing(L, "sine_in", R_ease_sine_in);
    set_named_easing(L, "sine_out", R_ease_sine_out);
    set_named_easing(L, "sine_in_out", R_ease_sine_in_out);
    set_named_easing(L, "expo_in", R_ease_expo_in);
    set_named_easing(L, "expo_out", R_ease_expo_out);
    set_named_easing(L, "expo_in_out", R_ease_expo_in_out);
    lua_rawsetp(L, LUA_REGISTRYINDEX, &easings_dummy);
}

R_EaseFn R_lua_named_ease(lua_State *L, int name_index)
{
    lua_rawgetp(L, LUA_REGISTRYINDEX, &easings_dummy);
    lua_pushvalue(L, name_index);
    lua_gettable(L, -2);

    R_EaseFn ease;
    if (lua_isnil(L, -1)) {
        ease = NULL;
    }
    else {
        R_LuaEaseFn *le = XL_checkutype(L, -1, "R_LuaEaseFn");
        R_MAGIC_CHECK(R_LuaEaseFn, le);
        ease = le->ease;
    }

    lua_pop(L, 2);
    return ease;
}


static int init(lua_State *L);

int R_lua_ease_init(lua_State *L)
{
    lua_pushcfunction(L, init);
    lua_call(L, 0, 0);
    init_named_easings(L);
    return 0;
}

static luaL_Reg r_ease_function_registry_xl[] = {
    {"back_in", r_ease_back_in_xl},
    {"back_in_out", r_ease_back_in_out_xl},
    {"back_out", r_ease_back_out_xl},
    {"bounce_in", r_ease_bounce_in_xl},
    {"bounce_in_out", r_ease_bounce_in_out_xl},
    {"bounce_out", r_ease_bounce_out_xl},
    {"cubic_in", r_ease_cubic_in_xl},
    {"cubic_in_out", r_ease_cubic_in_out_xl},
    {"cubic_out", r_ease_cubic_out_xl},
    {"elastic_in", r_ease_elastic_in_xl},
    {"elastic_in_out", r_ease_elastic_in_out_xl},
    {"elastic_out", r_ease_elastic_out_xl},
    {"expo_in", r_ease_expo_in_xl},
    {"expo_in_out", r_ease_expo_in_out_xl},
    {"expo_out", r_ease_expo_out_xl},
    {"linear", r_ease_linear_xl},
    {"quad_in", r_ease_quad_in_xl},
    {"quad_in_out", r_ease_quad_in_out_xl},
    {"quad_out", r_ease_quad_out_xl},
    {"quart_in", r_ease_quart_in_xl},
    {"quart_in_out", r_ease_quart_in_out_xl},
    {"quart_out", r_ease_quart_out_xl},
    {"quint_in", r_ease_quint_in_xl},
    {"quint_in_out", r_ease_quint_in_out_xl},
    {"quint_out", r_ease_quint_out_xl},
    {"sine_in", r_ease_sine_in_xl},
    {"sine_in_out", r_ease_sine_in_out_xl},
    {"sine_out", r_ease_sine_out_xl},
    {NULL, NULL},
};

static int init(lua_State *L)
{
    XL_initmetatable(L, "R_LuaEaseFn", NULL);
    XL_initfunctions(L, r_ease_function_registry_xl, "R", "Ease", (const char *)NULL);
    return 0;
}
